<!DOCTYPE html>
<html>
<head>

		





	    


	    

	
            <title>PostgreSQL HA with pgpool-II - Part 6 - Blog - Confluence</title>
	
        

                        
    
                        
    

            <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="/confluence">
<meta id="confluence-base-url" name="confluence-base-url" content="https://www.itenlight.com/confluence">

<meta id="atlassian-token" name="atlassian-token" content="7aa662486ae87f31a861cf8b69bc8808006ee07b">


<meta id="confluence-space-key" name="confluence-space-key" content="BLOG">
<script type="text/javascript">
        var contextPath = '/confluence';
</script>

    

    <meta name="confluence-request-time" content="1479214866871">
        
    
        
            <meta name="ajs-is-space-admin" content=""> <meta name="ajs-has-space-config" content="">
            <style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="stp-license-product-name" content="Confluence"/> <meta name="stp-license-days-to-expiry" content="178"/> <meta name="stp-license-is-admin" content="false"/> <meta name="stp-license-should-keep-banner-hidden" content="true"/>
            <meta name="ajs-keyboardshortcut-hash" content="e512dc1b82456f61e1e06fcb0a019072">
            <meta id="team-calendars-has-jira-link" content="true">
            <meta name="ajs-team-calendars-display-time-format" content="displayTimeFormat12">
            <meta id="team-calendars-display-week-number" content="false">
            <meta id="team-calendars-user-timezone" content="Europe/Belgrade">
            <script type="text/x-template" id="team-calendars-messages" title="team-calendars-messages"><fieldset class="i18n hidden"><input type="hidden" name="calendar3.month.long.july" value="July"><input type="hidden" name="calendar3.day.short.wednesday" value="Wed"><input type="hidden" name="calendar3.day.short.thursday" value="Thu"><input type="hidden" name="calendar3.month.short.march" value="Mar"><input type="hidden" name="calendar3.month.long.april" value="April"><input type="hidden" name="calendar3.month.long.october" value="October"><input type="hidden" name="calendar3.month.long.august" value="August"><input type="hidden" name="calendar3.month.short.july" value="Jul"><input type="hidden" name="calendar3.month.short.may" value="May"><input type="hidden" name="calendar3.month.short.november" value="Nov"><input type="hidden" name="calendar3.day.long.friday" value="Friday"><input type="hidden" name="calendar3.day.long.sunday" value="Sunday"><input type="hidden" name="calendar3.day.long.saturday" value="Saturday"><input type="hidden" name="calendar3.month.short.april" value="Apr"><input type="hidden" name="calendar3.day.long.wednesday" value="Wednesday"><input type="hidden" name="calendar3.month.long.december" value="December"><input type="hidden" name="calendar3.month.short.october" value="Oct"><input type="hidden" name="calendar3.day.long.monday" value="Monday"><input type="hidden" name="calendar3.month.short.june" value="Jun"><input type="hidden" name="calendar3.day.short.monday" value="Mon"><input type="hidden" name="calendar3.day.short.tuesday" value="Tue"><input type="hidden" name="calendar3.day.short.saturday" value="Sat"><input type="hidden" name="calendar3.month.long.march" value="March"><input type="hidden" name="calendar3.month.long.june" value="June"><input type="hidden" name="calendar3.month.short.february" value="Feb"><input type="hidden" name="calendar3.month.short.august" value="Aug"><input type="hidden" name="calendar3.month.short.december" value="Dec"><input type="hidden" name="calendar3.day.short.sunday" value="Sun"><input type="hidden" name="calendar3.month.long.february" value="February"><input type="hidden" name="calendar3.day.long.tuesday" value="Tuesday"><input type="hidden" name="calendar3.month.long.may" value="May"><input type="hidden" name="calendar3.month.long.september" value="September"><input type="hidden" name="calendar3.month.long.november" value="November"><input type="hidden" name="calendar3.month.short.january" value="Jan"><input type="hidden" name="calendar3.month.short.september" value="Sep"><input type="hidden" name="calendar3.day.long.thursday" value="Thursday"><input type="hidden" name="calendar3.month.long.january" value="January"><input type="hidden" name="calendar3.day.short.friday" value="Fri"></fieldset></script>
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            
    
    
            <meta name="ajs-page-id" content="3735725">
            <meta name="ajs-latest-page-id" content="3735725">
            <meta name="ajs-content-type" content="blogpost">
            <meta name="ajs-page-title" content="PostgreSQL HA with pgpool-II - Part 6">
            <meta name="ajs-parent-page-id" content="">
            <meta name="ajs-space-key" content="BLOG">
            <meta name="ajs-space-name" content="Blog">
            <meta name="ajs-jira-metadata-count" content="0">
            <meta name="ajs-context-path" content="/confluence">
            <meta name="ajs-base-url" content="https://www.itenlight.com/confluence">
            <meta name="ajs-version-number" content="5.9.10">
            <meta name="ajs-build-number" content="6218">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-remote-user-has-licensed-access" content="false">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-static-resource-url-prefix" content="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/_">
            <meta name="ajs-global-settings-attachment-max-size" content="104857600">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="applinks.v3.ui,confluence.wrap.macro.disable,clc.quick.create,confluence.view.edit.transition,cql.search.screen,confluence-inline-comments-resolved,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareContentEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.mentions.api.ConfluenceMentionEvent,nps.survey.inline.dialog,confluence.efi.onboarding.new.templates,notification.plugin.api.enabled.com.atlassian.confluence.event.events.security.ForgotPasswordEvent,pdf-preview,notification.plugin.api.enabled.com.atlassian.confluence.plugins.tasklist.event.SendTaskEmailEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageMovedEvent,previews.sharing,previews.versions,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentUpdateEvent,file-annotations,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.attachment.AttachmentBatchUploadCompletedEvent,confluence.efi.onboarding.rich.space.content,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentCreateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingLessUsersEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentRemoveEvent,confluence.wrap.macro,atlassian.aui.raphael.disabled,previews.conversion-service,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.follow.FollowEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageEditedEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostCreateEvent,previews.trigger-all-file-types,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentResolveEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.like.LikeCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentCreateEvent,previews.sharing.pushstate,confluence-inline-comments-rich-editor,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostUpdateEvent,file-annotations.likes,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentMentionUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingNoSpaceCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.hipchat.api.events.HipChatUserMapped,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareAttachmentEvent,confluence-inline-comments,quick-reload-inline-comments-flags,confluence-inline-comments-dangling-comment,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostMovedEvent">
            <meta name="ajs-atl-token" content="7aa662486ae87f31a861cf8b69bc8808006ee07b">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="dd MMM yyyy">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/_/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/_/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="/confluence/opensearch/osd.action" title="Confluence"/>

<script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/confluence\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources.is-server-instance-data-provider"]="true";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:/confluence(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\"daysBeforeLicenseExpiry\":0,\"daysBeforeMaintenanceExpiry\":0,\"showLicenseExpiryBanner\":false,\"showMaintenanceExpiryBanner\":false,\"renewUrl\":null,\"salesEmail\":null}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:discovery-javascript-data.link-active"]="{\"linkActive\":false,\"conditionsMet\":true,\"admin\":false}";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.analytics-enabled-data-provider"]="\"true\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.sen-data-provider"]="\"SEN-7331437\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider"]="true";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.rack-data-provider"]="\"\"";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common.applinks-context"]="{\"hostApplication\":{\"id\":\"88ebc2b4-1ec9-3912-8bef-6e77012a47e6\",\"type\":\"confluence\"}}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common.applinks-features"]="{\"BITBUCKET_REBRAND\":false,\"V3_UI_OPT_IN\":false,\"V3_UI\":false}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common.applinks-discovered-features"]="[]";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common.applinks-help-paths"]="{\"entries\":{\"applinks.docs.root\":\"https://confluence.atlassian.com/display/APPLINKS-050/\",\"applinks.docs.diagnostics.troubleshoot.sslunmatched\":\"SSL+and+application+link+troubleshooting+guide\",\"applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused\":\"OAuth+troubleshooting+guide\",\"applinks.docs.delete.entity.link\":\"Create+links+between+projects\",\"applinks.docs.adding.application.link\":\"Link+Atlassian+applications+to+work+together\",\"applinks.docs.administration.guide\":\"Application+Links+Documentation\",\"applinks.docs.oauth.security\":\"OAuth+security+for+application+links\",\"applinks.docs.troubleshoot.application.links\":\"Troubleshoot+application+links\",\"applinks.docs.diagnostics.troubleshoot.unknownerror\":\"Network+and+connectivity+troubleshooting+guide\",\"applinks.docs.configuring.auth.trusted.apps\":\"Configuring+Trusted+Applications+authentication+for+an+application+link\",\"applinks.docs.diagnostics.troubleshoot.authlevelunsupported\":\"OAuth+troubleshooting+guide\",\"applinks.docs.diagnostics.troubleshoot.ssluntrusted\":\"SSL+and+application+link+troubleshooting+guide\",\"applinks.docs.diagnostics.troubleshoot.unknownhost\":\"Network+and+connectivity+troubleshooting+guide\",\"applinks.docs.delete.application.link\":\"Link+Atlassian+applications+to+work+together\",\"applinks.docs.link.applications\":\"Link+Atlassian+applications+to+work+together\",\"applinks.docs.diagnostics.troubleshoot.oauthproblem\":\"OAuth+troubleshooting+guide\",\"applinks.docs.relocate.application.link\":\"Link+Atlassian+applications+to+work+together\",\"applinks.docs.administering.entity.links\":\"Create+links+between+projects\",\"applinks.docs.upgrade.application.link\":\"OAuth+security+for+application+links\",\"applinks.docs.diagnostics.troubleshoot.connectionrefused\":\"Network+and+connectivity+troubleshooting+guide\",\"applinks.docs.configuring.auth.oauth\":\"OAuth+security+for+application+links\",\"applinks.docs.insufficient.remote.permission\":\"OAuth+security+for+application+links\",\"applinks.docs.configuring.application.link.auth\":\"OAuth+security+for+application+links\",\"applinks.docs.diagnostics\":\"Application+links+diagnostics\",\"applinks.docs.configured.authentication.types\":\"OAuth+security+for+application+links\",\"applinks.docs.adding.entity.link\":\"Create+links+between+projects\",\"applinks.docs.diagnostics.troubleshoot.unexpectedresponse\":\"Network+and+connectivity+troubleshooting+guide\",\"applinks.docs.configuring.auth.basic\":\"Configuring+Basic+HTTP+Authentication+for+an+Application+Link\",\"applinks.docs.diagnostics.troubleshoot.authlevelmismatch\":\"OAuth+troubleshooting+guide\"}}";
</script>
<link type="text/css" rel="stylesheet" href="/confluence/s/775249c1ad7a298a6b9a703040f09a72-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/80/_/download/superbatch/css/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/80/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/80/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/confluence/s/e1043264f3e70660da8480ec5aad97c9-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/47df700daed3c4f64dac392db18d0411/_/download/contextbatch/css/blogpost,viewcontent,atl.general,main,atl.comments/batch.css?confluence.view.edit.transition=true&amp;highlightactions=true&amp;custom-site-logo=true" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/47df700daed3c4f64dac392db18d0411/_/download/contextbatch/css/blogpost,viewcontent,atl.general,main,atl.comments/batch.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/47df700daed3c4f64dac392db18d0411/_/download/contextbatch/css/blogpost,viewcontent,atl.general,main,atl.comments/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/90731515e1d37d44a291c7a04cec4f94-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/47df700daed3c4f64dac392db18d0411/_/download/contextbatch/css/blogpost,viewcontent,atl.general,main,atl.comments/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:shared-batch/com.refinedwiki.confluence.plugins.theme.original:shared-batch.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:core-resources/com.refinedwiki.confluence.plugins.theme.original:core-resources.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:core-resources/com.refinedwiki.confluence.plugins.theme.original:core-resources.css?content-type=text%2Fcss&amp;media=print" media="print">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:batch/com.refinedwiki.confluence.plugins.theme.original:batch.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/3/_/styles/colors.css?spaceKey=BLOG" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/resources/com.refinedwiki.confluence.plugins.theme.original:RefinedWikiTheme50/default-theme.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/3/_/styles/theme-colors.css?completeModuleKey=com.refinedwiki.confluence.plugins.theme.original%3ARefinedWikiTheme50&amp;stylesheetName=color-scheme.css&amp;spaceKey=BLOG" media="all">
<script type="text/javascript" src="/confluence/s/b5041722346a7574e2fdeb61b0309428-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/80/_/download/superbatch/js/batch.js?atlassian.aui.raphael.disabled=true&amp;locale=en-GB" ></script>
<script type="text/javascript" src="/confluence/s/fcca1b6fd9661f31dd050a7767db6cdb-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/47df700daed3c4f64dac392db18d0411/_/download/contextbatch/js/blogpost,viewcontent,atl.general,main,atl.comments/batch.js?confluence.view.edit.transition=true&amp;highlightactions=true&amp;build-number=6218&amp;nps-acknowledged=true&amp;analytics-enabled=true&amp;locale=en-GB&amp;anonymous-access-enabled=true&amp;is-server-instance=true&amp;nps-enabled=true&amp;hostenabled=true" ></script>
<script type="text/javascript" src="/confluence/s/6c0981174e94142364564819dc0d1413-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:shared-batch/com.refinedwiki.confluence.plugins.theme.original:shared-batch.js?locale=en-GB" ></script>
<script type="text/javascript" src="/confluence/s/6c0981174e94142364564819dc0d1413-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/5.0.9/_/download/batch/com.refinedwiki.confluence.plugins.theme.original:core-resources/com.refinedwiki.confluence.plugins.theme.original:core-resources.js?locale=en-GB" ></script>
<script type="text/javascript" src="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/1.0/_/download/batch/confluence.web.resources:moment/confluence.web.resources:moment.js" ></script>

    
        
            <meta name="stp-license-product-name" content="Confluence"/> <meta name="stp-license-days-to-expiry" content="178"/> <meta name="stp-license-is-admin" content="false"/> <meta name="stp-license-should-keep-banner-hidden" content="true"/>
    

        


    

		








<script>
	
			if (typeof RW === 'undefined') {
    	var RW = {};
	}
	
		// Should not be used - but kept for third parties. Use RW.versionChecker instead.
	RW.confluenceVersion = 5.91;
    RW.versionChecker = {
	  comparedTo510: -1,
	  comparedTo59: 1,
	  comparedTo58: 1,
	  comparedTo57: 1
	};

		
	
		RW.isConfluenceAdministrator = false
	
				var contextPath = '/confluence';
	
					RW.scrollSearchActive = true;
	
            RW.blogPortalEnabled = true
    
		RW.userDashboardRedirection = true;
	
			
		var originalTheme = RW;
	
		RW.cacheSettings = {};
	RW.cacheSettings.params = {};
	RW.cacheSettings.lastChange = {}

	    
    		RW.cacheSettings.params['footer'] = true;
    	    		RW.cacheSettings.params['userdetails'] = true;
    	    		RW.cacheSettings.params['globalmenu'] = true;
    	    		RW.cacheSettings.params['usercategory'] = true;
    	    		RW.cacheSettings.params['category'] = true;
    	    		RW.cacheSettings.params['docache'] = false;
    	            			RW.cacheSettings.lastChange['footer'] = 1478237216427;
        			RW.cacheSettings.lastChange['userdetails'] = 1478237216427;
        			RW.cacheSettings.lastChange['globalmenu'] = 1478237216427;
        			RW.cacheSettings.lastChange['usercategory'] = 1478237216427;
        			RW.cacheSettings.lastChange['category'] = 1478514243951;
    	RW.activeCategoryKey = '';

  // Keyboard shortcuts add-on status
  RW.shortcutsEnabled = function() {
	return Confluence && Confluence.KeyboardShortcuts && Confluence.KeyboardShortcuts.enabled;
  }
</script>



	
				
	

<!--[if !IE]><!-->
 	<style type="text/css">
		.rw_toolbar_menu li .rw_toolbar_dropdown li a:hover
		{
			color: #ffffff;	
			background: #3572b0;
		}
		
		/* Scroll office fix */
		#com-k15t-confluence-scroll-pdf-launcher:hover
		{
			color: #ffffff;	
			background: #3572b0;
		}
	</style>
<!--<![endif]-->

		
<!--[if IE 6]>
	<link type="text/css" rel="stylesheet" href="/confluence/download/resources/com.refinedwiki.confluence.plugins.theme.original/styles/legacy/ie6-fix.css" media="all"/>
<![endif]-->

<!--[if IE 7]>
	<link type="text/css" rel="stylesheet" href="/confluence/download/resources/com.refinedwiki.confluence.plugins.theme.original/styles/legacy/ie7-fix.css" media="all"/>
<![endif]-->







			
		


            
            
            


            
            
            


            
            
            


            
            
            


            
            
                                                                                                                                                                                                                                    
            

	<link type="text/css" rel="stylesheet" href="/confluence/plugins/servlet/rw-resources/themes/2/css/theme-2-1.css" media="all">


			<style type="text/css">
  #rw_wrapper.rw_effects_popup_shadow .rw_shadow_top { width: calc(100% + 40px); }
  #rw_wrapper.rw_effects_popup_shadow .rw_shadow_top:after { width: calc(100% - 40px); }
  #rw_wrapper.rw_effects_popup_border .rw_shadow_top { width: calc(100% + 2px); }
</style>




<style type="text/css">
	/* Key navigation in popup */
	li.rw_selected a { background: #fd9602 !important; border-color: #fd9602 !important; }
	li.rw_selected * { color: #fff !important; }
	li.rw_selected a span.rw_item_left { background: none !important; border-color:none !important;}
	
	/* Key navigation category menu */
	#rw_category_menu ul li.rw_active.rw_selected a > span { border-color: #fd9602; }
	
	/* Key navigation for page tree */
	.rw_pagetree_list li.rw_selected > div.rw_icon_content { background: #fd9602 !important; border-color: #fd9602 !important; }
	.rw_pagetree_list li.rw_selected > div.rw_icon_content a { color:#fff !important;}
	.rw_pagetree_list li.rw_selected a {background: none !important; border-color: none; color:#333 !important;}
	
	/* Key navigation for activity popup */
	li.rw_selected div.rw_no_link { background: #fd9602 !important; border-color: #fd9602 !important; }
	
	/* Main Key Navigation */
	.rw_keynavigation_row > div.rw_selected { background: #fd9602 !important; color:#fff !important;}
	.rw_keynavigation_container > div.rw_keynavigation_empty_item { background: none;}
	
	/* Menu keynav exceptions */
	#notifications-anchor.rw_selected {background: #fd9602 !important; color:#fff !important;}
	
	
	

	#rw_menu_bar #rw_create_button .aui-button,
	#rw_inline_dialog_page_menu #rw_create_button .aui-button,
    .rw_create_blogpost_button.aui-button
	{
	  background-image: -moz-linear-gradient(top, #3572b0, #2d6195);
	  background-image: -ms-linear-gradient(top,  #3572b0, #2d6195);
	  background-image: -webkit-linear-gradient(top,  #3572b0, #2d6195);
	  background-image: -o-linear-gradient(top,  #3572b0, #2d6195);
	  background-image: linear-gradient(top,  #3572b0, #2d6195);
	  text-shadow: none;
	  color: #ffffff;
	}

    #rw_menu_bar #rw_create_button .aui-button,
    #rw_inline_dialog_page_menu #rw_create_button .aui-button,
    .rw_create_blogpost_button.aui-button
    {
      border-color: #3572b0;
    }
    #rw_main #rw_create_button .aui-button:hover,
    #rw_main #rw_create_button .aui-button:focus,
    #rw_inline_dialog_page_menu #rw_create_button .aui-button:hover,
    #rw_inline_dialog_page_menu #rw_create_button .aui-button:focus,
    .rw_create_blogpost_button.aui-button:hover,
    .rw_create_blogpost_button.aui-button:focus
    {
      background-image: -moz-linear-gradient(top, #3089e3, #31669b);
      background-image: -ms-linear-gradient(top, #3089e3, #31669b);
      background-image: -webkit-linear-gradient(top, #3089e3, #31669b);
      background-image: -o-linear-gradient(top, #3089e3, #31669b);
      background-image: linear-gradient(top, #3089e3, #31669b);
    }

    .rw_create_blogpost_button.aui-button {
	  border: 0;
    }
    .rw_create_blogpost_button.aui-button:hover {
      color: #ffffff;
	}

	
				
	
	
    	        #com-atlassian-confluence #inline-dialog-notifications-miniview
        {
            position:fixed;
            top: 57px !important;
            right: 80px !important;
			margin: 0px !important;
        }
        #com-atlassian-confluence #inline-dialog-notifications-miniview:after,
        #com-atlassian-confluence #inline-dialog-notifications-miniview:before
        {
            border: medium solid transparent;
            bottom: 100%;
            content: " ";
            height: 0;
            pointer-events: none;
            position: absolute;
            width: 0;
        }
        #com-atlassian-confluence #inline-dialog-notifications-miniview:after
        {
            
            border-color: rgba(237, 237, 237, 0) rgba(237, 237, 237, 0) rgba(237, 237, 237, 0) #fff;
            border-width: 8px;  
            top:22px;
            right: -15px;   
        }
        #com-atlassian-confluence #inline-dialog-notifications-miniview:before
        {
            border-color: rgba(221, 221, 221, 0) rgba(221, 221, 221, 0) rgba(221, 221, 221, 0) #ddd;
            border-width: 10px;  
            top: 20px;
            right: -19px;
        }
        #com-atlassian-confluence #inline-dialog-notifications-miniview #arrow-notifications-miniview
        {
            display:none;
        }
	

</style>



    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78446365-2', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript">//<![CDATA[
	var buyBeerImages = Array();
	buyBeerImages[0] = new Image(120, 120);
	buyBeerImages[0].src = "/confluence/fdfiles/small.png";
	buyBeerImages[1] = new Image(120, 120);
	buyBeerImages[1].src = "/confluence/fdfiles/big.png";
	buyBeerImages[2] = new Image(120, 120);
	buyBeerImages[2].src = "/confluence/fdfiles/lot.png";

	function switchBeerImage(e) {
		var selectElement = AJS.$(e.target);
		var imgIdx = parseInt(selectElement.find(":selected").attr('data-beer-index'));
		var theForm = selectElement.closest("form");
		theForm.find("input[type='image']").attr('src', buyBeerImages[imgIdx].src);
	}
//]]>
</script>

    
                <link rel="canonical" href="https://www.itenlight.com/blog/2016/05/25/PostgreSQL+HA+with+pgpool-II+-+Part+6">
        <link rel="shortlink" href="https://www.itenlight.com/confluence/x/rQA5">
    <meta name="wikilink" content="[BLOG:/2016/05/25/PostgreSQL HA with pgpool-II - Part 6]">
    <meta name="page-version" content="23">


        

    
</head>

<body      id="com-atlassian-confluence" class="RefinedWikiTheme50 rw_version_5 view-blog-post aui-layout aui-theme-default confluence_5   lighter-editor   rw_body_gray rw_category_dd_theme_dark rw_popup_design_default   ">


        
            <div id='stp-licenseStatus-banner'></div>
    <ul id="assistive-skip-links" class="assistive">
    <li><a href="#rw_page_title">Skip to content</a></li>
    <li><a href="#rw_page_breadcrumbs">Skip to breadcrumbs</a></li>
    <li><a href="#rw_category_menu">Skip to header menu</a></li>
    <li><a href="#navigation">Skip to action menu</a></li>
    <li><a href="#rw_search_query">Skip to quick search</a></li>
</ul>


<div id="page">
<div id="full-height-container">
   
      <div id="header" style="display:none;"></div>
   
   <div id="header-precursor">
        <div class="cell">
            <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
                        </div>
    </div>
	
						
		
				



	






























































					<div 
	id="rw_side_menu_hidden_by_apache" style="display:none;visibility:hidden;"

	    	class=" rw_theme_dark"
	
	data-mode="open" 
	>
	<div id="rw_side_menu_handle" class="rw_handle"></div> 
    <div id="rw_side_menu_container">
		<ul>
	                                				
        
        
<li><a  id="login-link" href="/confluence/login.action?os_destination=%2Fdisplay%2FBLOG%2F2016%2F05%2F25%2FPostgreSQL%2BHA%2Bwith%2Bpgpool-II%2B-%2BPart%2B6" class="  user-item login-link "      title="" >
        Log in
</a></li>
                        				
        			
				
	    <li><a id="help-menu-link" href="#" title="Help" class="rw_has_dd rw_tooltip" data-dd="help-menu-link-dd" data-tooltip="Help">
      <span class="rw_item_icon aui-iconfont-help"></span>
    </a>
      <nav id="help-menu-link-dd" class="rw_side_menu_dd" data-owner="help-menu-link">
		              <div class="rw_section">
              <ul  id="help-menu-link-leading" class="section-leading first">
				                          
    
        
<li><a  id="confluence-help-link" href="https://docs.atlassian.com/confluence/docs-59/Getting+Help+And+Support" class="   "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a></li>
                                            
    
        
<li><a  id="keyboard-shortcuts-link" href="/confluence" class="   "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a></li>
                                            
    
        
<li><a  id="feed-builder-link" href="/confluence/dashboard/configurerssfeed.action" class="   "      title="Create your custom RSS feed." >
        Feed Builder
</a></li>
                                            
    
        
<li><a  id="whats-new-menu-link" href="https://confluence.atlassian.com/display/DOC/Confluence+5.9+Release+Notes" class="   "      title="" >
        What’s new
</a></li>
                                            
    
        
<li><a  id="gadget-directory-link" href="/confluence" class="  user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a></li>
                                            
    
        
<li><a  id="confluence-about-link" href="/confluence/aboutconfluencepage.action" class="   "      title="Get more information about Confluence" >
        About Confluence
</a></li>
                                  </ul>
            </div>
		        </nav>
    </li>
	
	    </ul>
		<ul>
			<li>	
				<a id="rw_search_popup_button" title="Search">
        			<span class="rw_item_icon rw_iconfont_search"></span>
        		</a>
			</li>
		</ul>	
	
    </div>
    <div class="rw_done_cover"></div> 
</div>
		
				
				



        



		<div id="rw_wrapper" class="rw_menu_layout_v2  rw_blog_space     rw_background_partial rw_effects_popup_shadow rw_header_theme_1row rw_header_height_space rw_category_menu_theme_traditional rw_content_menu_transparent rw_content_spaces_gray3 rw_content_menu_open ">

			<div id="rw_main">

								
									    <div id="rw_theme_header" class=" rw_corners_rounded rw_text_size_regular rw_logo_size_medium">

                
                    <div class="rw_row_1 rw_header_row">

                                                    <div class="rw_header_left rw_has_logo ">
                        
		                        	




<div id="rw_logo_container" class="  ">
		<a href="/">
		<img src="/confluence/download/attachments/327682/atl.site.logo?version=2&amp;modificationDate=1465094613765&amp;api=v2" />
	</a>

		
		</div>
                    </div>
                

                                <div class="rw_header_center">	
		
		
		<div id="rw_category_menu" 
		class=" rw_version_3 rw_theme_traditional  rw_corners_rounded rw_text_size_regular  "
		>

					<div id="rw_category_menu_scroll_container">
					<ul class="rw_category_items">
				                           </ul>
					</div><!-- # rw_category_menu_scroll_container -->
			</div>		

		<div id="rw_category_menu_parameters" style="display:none;"
		 data-drop-down-content-size="medium"
	  >
	
						<div id="rw_category_dd_disabled">false</div>
		<div id="rw_category_dd_layout">dynamic_column</div>
		<div id="rw_sub_category_collapsed">false</div>
		<div id="rw_show_category_logo">false</div>
		<div id="rw_exclude_archived_spaces">false</div>
		<div id="rw_show_space_logo">false</div>
		<div id="rw_show_space_icon">false</div>
		<div id="rw_min_column_width">340</div>
		<div id="rw_active_category_key"></div>
		<div id="rw_is_dashboard"></div>
		<div id="rw_manual_permissions">false</div>
		<div id="rw_disable_category_dashboards">false</div>
		<div id="rw_disable_subcategory_dashboards">false</div>
		          <div id="rw_version">3</div>
			  	<div id="rw_dashboard_title"></div>
	</div>

</div>

                                <div class="rw_header_right ">
                                           
                    	<div id="rw_search_container">
		<div id="rw_search" class="rw_search">
			
						<form style="width:0px; height:0px; overflow:hidden; "><input type="text" name="hack" onfocus="this.blur()" /></form>
			    
			<form id="rw_search_form" class="rw_search_form" method="get" action="/confluence/dosearchsite.action">
		   		<label for="rw_search_query" class="assistive">Quick Search</label>
				<input class="rw_search_query" id="rw_search_query" type="text" accessKey="search-pages-action.accesskey" autocomplete="off" name="queryString" size="25" />
		    
		   		<div style="clear:both;"></div>
		        <div id="rw_search_result_container" class="rw_search_result_container rw_corners" style="display:none;">
		        	
		        </div>
		
		        <fieldset class="hidden parameters">
		            <input type="hidden" id="quickNavEnabled" value="true" />
		            		        </fieldset>
		    </form>	
	    </div>
	</div>

                                        	
	
	                </div>

            </div>
            </div>

<div id="rw_theme_content" class="">
<div style="clear:both;"></div>

	
			
		
			<div style="clear:both;"></div>


									

		    <div id="main" >

													

			


				
		

<div id="rw_menu_bar_wrapper" class="" >
		
	
	<div id="rw_menu_bar" class="rw_corners" >

				          <div class="rw_create_button_container"><table><tr><td style="vertical-align:top;"><a href="https://twitter.com/share" class="twitter-share-button"></a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></td><td style="vertical-align:top;padding-left:10px;"><div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div></td><td style="vertical-align:top;padding-left:10px;"><g:plusone size="medium"></g:plusone></td></tr></table></div><div class="rw_create_button_container_hidden_by_apache" style="display:none;visibility:hidden;"><a class="aui-button aui-button-primary rw_create_blogpost_button" href="/confluence/pages/createblogpost.action?spaceKey=BLOG"><span>Create blog post</span></a></div>
		

				
										
				

								
				
			



<div id="rw_space_nav" class="rw_corners">

    <div class="rw_item_content ">
                <a
            title="Blog"
                            href="/blog"
                                >

            Blog
                                                                </a>
    </div>

    
            <div id="rw_space_menu_button_hidden_by_apache" style="display:none;visibility:hidden;">
            <span class="rw_icon rw_iconfont_top_menu"></span>
        </div>
                    
			
		
        <div id="browse-space-menu" style="display:none;" >

									<ul>
			  	<h3 class="rw_section_title">Space Tools</h3>

				
									<li>
						
																									
						<a title="Overview" href="/confluence/spaces/viewspacesummary.action?key=BLOG">
															<span class="rw_item_icon rw_iconfont_text"></span>
														<span class="rw_item_content">Overview</span>
						</a>

																	</li>
									<li>
						
																									
						<a title="Content Tools" href="/confluence/pages/reorderpages.action?key=BLOG">
															<span class="rw_item_icon rw_iconfont_tree"></span>
														<span class="rw_item_content">Content Tools</span>
						</a>

																	</li>
							</ul>

		</div>
	            </div>

		

	</div> <!-- #rw_menu_bar -->
</div> <!-- #rw_menu_bar_wrapper -->
				

												
		
		        

								
					
											    <div class="rw_content_section blogpost view">
    <div id="rw_main_column" class="rw_has_right_column">
        <!--
          #rw_page_right is @deprecated @since RWOT 3.1 the id of this tag will be
          removed in future version of this theme. NOTE: The div-tag will remain
          it's just the ID which will be removed.

          id="rw_page_right"
          id="blogpost_container"
        -->
        <div class="rw_content">

            

                           


                <div class="rw_profile_pic">
            <a  class="userLogoLink" data-username="peske" href="    /confluence/display/~peske
">
               <img class="userLogo logo" src="/confluence/download/attachments/327691/user-avatar?version=1&amp;modificationDate=1462000142995&amp;api=v2"
               alt="User icon: peske" title="peske">
           </a>        </div>
        <div id="main-header" class="rw_has_profile_pic">

                <div class="rw_page_buttons">
    <a id="rw_open_fullscreen" title="Open page in fullscreen ( Type 'F', shift + f )" class="aui-button aui-button-subtle" href="#">
        <span>
			<span class="rw_icon rw_iconfont_fullscreen"></span>
		</span>
    </a>
    <a id="rw_close_fullscreen" style="display:none;" class="aui-button aui-button-subtle" title="Exit fullscreen mode ( Type 'esc' )">
        <span>
            <span class="rw_icon rw_iconfont_minimize"></span>
        </span>
    </a>
</div>

                

								

                
    <div id="navigation_hidden_by_apache" style="display:none;visibility:hidden;" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                            
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-primary"                         class="section-primary first">
                                                    <li>

    
        
                                            
    
    
    <a  id="view-attachments-link" href="/confluence/pages/viewpageattachments.action?pageId=3735725" rel="nofollow" class="action-view-attachments"  accessKey="t"  title="View Attachments">
                <span>
                        A<u>t</u>tachments (10)
        </span>    </a>
</li>
                                                <li>

    
        
                                            
    
    
    <a  id="action-view-history-link" href="/confluence/pages/viewpreviousversions.action?pageId=3735725" rel="nofollow" class="action-view-history"   title="">
                <span>
                        Page History
        </span>    </a>
</li>
                                        </ul>
                </div>
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-secondary"                         class="section-secondary">
                                                    <li>

    
        
                                            
    
    
    <a  id="view-page-info-link" href="/confluence/pages/viewinfo.action?pageId=3735725" rel="nofollow" class="action-view-info"   title="">
                <span>
                        Page Information
        </span>    </a>
</li>
                                                <li>

    
        
                                            
    
    
    <a  id="view-resolved-comments" href="/confluence" rel="nofollow" class=""   title="">
                <span>
                        Resolved comments
        </span>    </a>
</li>
                                                <li>

    
        
                                            
    
    
    <a  id="link-to-page-link" href="/confluence/pages/viewinfo.action?pageId=3735725" rel="nofollow" class=""   title="Link to this Page">
                <span>
                        Link to this Page…
        </span>    </a>
</li>
                                                <li>

    
        
                                            
    
    
    <a  id="action-view-source-link" href="/confluence/plugins/viewsource/viewpagesrc.action?pageId=3735725" rel="nofollow" class="action-view-source popup-link"   title="">
                <span>
                        View Source
        </span>    </a>
</li>
                                                <li>

    
        
                                            
    
    
    <a  id="action-export-pdf-link" href="/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=3735725" rel="nofollow" class=""   title="">
                <span>
                        Export to PDF
        </span>    </a>
</li>
                                        </ul>
                </div>
                    </div>
    </li>
            </ul>
    </div>

        


         <div id="title-heading" class="pagetitle with-breadcrumbs">

                            <div id="breadcrumb-section_hidden_by_apache" style="display:none;visibility:hidden;">
                    
    
    
    <ol id="breadcrumbs">
                                        
                        
        <li class="first" >
                        
                            <span class=""><a href="/confluence/pages/viewrecentblogposts.action?key=BLOG">Blog</a></span>
                                                                    
                        
        <li>
                        
                            <span class="">2016</span>
                                                                    
                        
        <li>
                        
                            <span class=""><a href="/blog/2016/05">May</a></span>
                                                                    
                        
        <li>
                        
                            <span class="">25</span>
                                                    </ol>


                </div>
            
            
		<a href="#page-banner-end" class="assistive">Skip to end of banner</a>
<div id="page-banner-start" class="assistive"></div>

			        
            <div id="page-metadata-banner"><ul class="banner"><li id="system-content-items" class="noprint"><a href="" title="Unrestricted" id="content-metadata-page-restrictions-hidden" class="hidden"></a><a href="/confluence/pages/viewpageattachments.action?pageId=3735725&amp;metadataLink=true" title="10 attachments" id="content-metadata-attachments" class="aui-icon aui-icon-small aui-iconfont-attachment"></a></li><li class="page-metadata-item noprint has-button"  id="content-metadata-jira-wrapper"><a href="" title="" id="content-metadata-jira" class="aui-button aui-button-subtle content-metadata-jira tipsy-disabled hidden"><span>JIRA links</span></a></li></ul></div>
    		

<a href="#page-banner-start" class="assistive">Go to start of banner</a>
<div id="page-banner-end" class="assistive"></div>
	


                            <h1 id="title-text" class="with-breadcrumbs">
                                                        <a href="/blog/2016/05/25/PostgreSQL+HA+with+pgpool-II+-+Part+6">PostgreSQL HA with pgpool-II - Part 6</a>
                                        </h1>
                    </div>
    </div><!-- \#main-header -->



            
            
    
    

        




            
    <!-- this is blogpost.vmd -->










	



    
    
        
    
    
                    
    

	                    
    
	



	

		

		

		

	
                	



<div id="action-messages">
                        </div>






	
		                    
    
    










<div class="rw_blogpost_content">

		
						        	<div style="display:none;visibility:hidden;">
				  <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
            <li class="page-metadata-modification-info">
                
        
    
        
    
        
            
            Created by <span class='author'>     <a href="    /confluence/display/~peske
"
                       class="url fn confluence-userlink" data-username="peske"
                            >Aleksandar Pesic</a></span>, last modified on <a class='last-modified' title='Show changes' href='/confluence/pages/diffpagesbyversion.action?pageId=3735725&amp;selectedPageVersions=22&amp;selectedPageVersions=23'>Jun 13, 2016</a>
                </li>
        </ul>
    </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>
	  </div>
	
		  
	
	

		

	
	<div style="clear:both;"></div>	
	<div id="content" class="blogpost view">
				<article>
			<div id="main-content" class="wiki-content">
							  	<style></style>
			                                                    
        <div class="wiki-content">
            <!-- SEOManager:keywords=postgresql, pgpool, high-availability, replication
composedTitle=PostgreSQL HA with pgpool-II - Part 6
author=peske
description=If you want to implement PostgreSQL high-availability cluster by using pgpool-II here&amp;apos;s complete, comprehensive tutorial for you.
title=PostgreSQL HA with pgpool-II - Part 6
:SEOManager --><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Support by sharing!</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>If you like the tutorial please share it with your friends. G+, Facebook and Twitter buttons are in the upper right corner of this page. <strong>Thanks!</strong> </p></div></div><p>This is the sixth (and hopefully the last) part of the tutorial. Other parts are:</p><ul><li><a href="/blog/2016/05/18/PostgreSQL+HA+with+pgpool-II+-+Part+1">PostgreSQL HA with pgpool-II - Part 1</a></li><li><a href="/blog/2016/05/19/PostgreSQL+HA+with+pgpool-II+-+Part+2">PostgreSQL HA with pgpool-II - Part 2</a></li><li><a href="/blog/2016/05/23/PostgreSQL+HA+with+pgpool-II+-+Part+3">PostgreSQL HA with pgpool-II - Part 3</a></li><li><a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+4">PostgreSQL HA with pgpool-II - Part 4</a></li><li><a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+5">PostgreSQL HA with pgpool-II - Part 5</a></li><li><strong>PostgreSQL HA with pgpool-II - Part 6</strong></li></ul><p>Start from the first part or give up!</p><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.1.AdditionalPackages">6.1. Additional Packages</h2><p>We need to install few more packages:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">apt-get install iputils-arping apache2 php5 libapache2-mod-php5 php5-pgsql</pre>
</div></div><p>First I must admit that I'm not sure if <code>iputils-arping</code> is the right choice. Watchdog needs <code>arping</code> command, but there are two packages in Ubuntu apt store that are offering it: <code>iputils-arping</code><span> (I've used above), and </span><code>arping</code><span>. I'm not 100% sure which should be installed, and I selected the first one only because it understands flags that are used in </span><code>pgpool.conf</code><span> template file (</span><code>arping_cmd = 'arping -U $_IP_$ -w 1'</code><span>). If you install </span><code>arping</code><span> package, </span><code>arping</code><span> command will complain about </span><code>-U</code><span> flag.</span></p><p><span>Apache and PHP are needed for pgpoolAdmin we'll install later.</span></p><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.2.ipandarping">6.2. <code>ip</code> and <code>arping</code></h2><p>If you remember from the last part, we've left two configuration options from <code>pgpool.conf</code> file (<code>if_cmd_path</code> and <code>arping_path</code>) for the next (this) part. Let's explain what is the issue with these: In order to be able to manipulate virtual IP pgpool-II needs to be able to execute <code style="line-height: 1.42857;">ip</code> and <code style="line-height: 1.42857;">arping</code> commands. But there's a catch: these commands are requiring root access, and as you might remember pgpool-II service runs under postgres user which doesn't have root permissions. It is true that we could let the service run as root, but again it wouldn't solve the problem - since we'll install and use pgpoolAdmin (which runs under Apache), www-data user (it is Apache user on Ubuntu) also needs to be able to execute these commands.</p><p>There are several ways to accomplish this, and many times mentioned <a class="external-link" href="http://www.pgpool.net/pgpool-web/contrib_docs/watchdog_master_slave/en.html" rel="nofollow">pgpool-II Tutorial [watchdog in master-slave mode]</a> from pgpool.net uses copying command binaries to user's home and changing permissions approprietely. Nevertheless, the tutorial also says:</p><p><em>&quot;Note that explained above should be used for tutorial purpose only. In the real world you'd better create setuid wrapper programs to execute ifconfig and arping. This is left for your exercise.&quot;</em></p><p>Well guyz, thanks for exercising me, but it would be much more helpful if you've actually showed how it should be done. Thanks for the tutorial that shows how it shouldn't be done.</p><p>Once again I'm left alone to find a way. I've already mentioned that there's a lot of ways to accomplish this, and I've select the one (not necessarily the best or the easiest).</p><h3 id="PostgreSQLHAwithpgpool-II-Part6-6.2.1.sudoersfile">6.2.1. <code>sudoers</code> file</h3><p>The first thing I'll do is to allow postgres and www-data users to sudo execute these commands without being prompted for root password. I've accomplished this by adding the following lines to <code>sudoers</code> file:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">postgres ALL=(root) NOPASSWD: /bin/ip
www-data ALL=(root) NOPASSWD: /bin/ip
postgres ALL=(root) NOPASSWD: /usr/bin/arping
www-data ALL=(root) NOPASSWD: /usr/bin/arping</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Never edit <code>sudoers</code> file with a normal text editor! Always use the <code>visudo</code> command instead! If you don't know how to do that, <a class="external-link" href="https://www.digitalocean.com/community/tutorials/how-to-edit-the-sudoers-file-on-ubuntu-and-centos" rel="nofollow">here</a> is one resource that may help.</p></div></div><p>You can add these lines at the end of the file. Of course confirm that paths provided are correct, and that they are pointing to an existing <code>ip</code> and <code>arping</code> files.</p><h3 id="PostgreSQLHAwithpgpool-II-Part6-6.2.2.CommandWrappers">6.2.2. Command Wrappers</h3><p>The next thing we'll do is creating simple wrapper scripts for mentioned commands. I'll place each script in the same directory where the command it wraps is, and I'll name the scripts by the wrapped command with suffix &quot;_w&quot;. Let's start with the wrapper for <code>ip</code> command:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>/bin/ip_w</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">#!/bin/bash
# By Fat Dragon, 05/26/2016
# Wraps ip command

if [ $UID -eq 0 ]
then
        #echo &quot;Executing: /bin/ip $@&quot;
        /bin/ip $@
else
        #echo &quot;Executing: sudo /bin/ip $@&quot;
        sudo /bin/ip $@
fi

exit 0</pre>
</div></div><p>Similarly, the script for <code>arping</code> command will be:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>/usr/bin/arping_w</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">#!/bin/bash
# By Fat Dragon, 05/26/2016
# Wraps arping command

if [ $UID -eq 0 ]
then
        #echo &quot;Executing: /usr/bin/arping $@&quot;
        /usr/bin/arping $@
else
        #echo &quot;Executing: sudo /usr/bin/arping $@&quot;
        sudo /usr/bin/arping $@
fi

exit 0</pre>
</div></div><p>Basically what the scripts do is forcing <code>sudo</code> execution of wrapped command if currently executing user is not root.</p><p>After the scripts are saved you'll need to set the permissions:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">chmod 0755 /bin/ip_w
chmod 0755 /usr/bin/arping_w</pre>
</div></div><p>After that you can confirm that postgres user is able to sudo-execute the commands without being prompted for password:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: RDark" data-theme="RDark">root@IT-RDBMS01:~# sudo -i -u postgres
postgres@IT-RDBMS01:~$ ip_w a
Executing: sudo /bin/ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 00:15:5d:05:05:20 brd ff:ff:ff:ff:ff:ff
    inet 10.1.10.150/16 brd 10.1.255.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::215:5dff:fe05:520/64 scope link
       valid_lft forever preferred_lft forever
postgres@IT-RDBMS01:~$ logout
root@IT-RDBMS01:~#</pre>
</div></div><p>Notice the third line (<code>Executing: sudo /bin/ip a</code>) - obviously we've succeeded executing <code>ip</code> command with <code>sudo</code>, without being prompted for password. Btw. this line will not appear if you comment out tracing <code>echo</code> statements in the scripts, as I've already did above. Actually I've reactivated echo lines only for this test execution, and commented them out again (a good wrapper should return the exact output gotten form the original command, nothing more).</p><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.3.Finishingpgpool-IIConfiguration">6.3. Finishing pgpool-II Configuration</h2><p>Finally we are ready to finish pgpool-II configuration. Set the following values in <code>pgpool.conf</code> file:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">if_cmd_path = &#39;/bin&#39;
if_up_cmd = &#39;ip_w addr add $_IP_$/24 dev eth0 label eth0:0&#39;
if_down_cmd = &#39;ip_w addr del $_IP_$/24 dev eth0&#39;
arping_path = &#39;/usr/bin&#39;
arping_cmd = &#39;arping_w -U $_IP_$ -w 1&#39;</pre>
</div></div><p>Notes:</p><ul><li>Previous values are very similar to default ones. I've changed only paths (if_cmd_path and arping_path), and command names (ip_w instead of ip and arping_w instead of arping).</li><li>I want to bring your attention to <code>$_IP_$/24</code> part: Actual iP address will be set automatically by pgpool (replacing <code>$_IP_$</code> placeholder). But you should set the subnet (<code>/24</code>) part appropriately, depending on your network.</li></ul><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.4.Authentication,AccessControlandpool_hba.conf">6.4. Authentication, Access Control and <code>pool_hba.conf</code></h2><p>When you think that the beast is defeated - pgpool-II strikes back with yet another catch. This time it is authentication, and this time is really hard to find any sane reason (besides we-want-you-suffer one) for them to implement authentication in a way they did. Let me explain what is all about. </p><p>pgpool-II introduces its own authentication mechanism, so that no client can connect to it if not authenticated properly. Sounds like reasonable decision, right? But wait, you need to know the whole story. Unreasonable thing is that pgpool's authentication does not replaces PostgreSQL authentication (which would also be wrong), but it simply adds another layer of authentication, so that a user first must to authenticate with pgpool, and then with PostgreSQL itself in order to execute a query. Having two authentications for a single query (single SELECT statement if you want) is already pointless and wrong. But actual problem is even bigger due to the fact that pgpool's authentication is poorly implemented, and does not uses existing PostgreSQL mechanism. It means that for every database user you'll have to:</p><ul><li>Manage his password in two different systems. The password has to be the same in both systems, but you must manage it separately, meaning that if you want to change the password you'll have to do so in PostgreSQL and pgpool.</li><li>You'll have to manage two host-based access (hba) files - <code>pg_hba.conf</code> (well known PostgreSQL's hba file) and <code>pool_hba.conf</code> (pgpool's hba file). Again, the setting in these files must be equivalent. For example I initially planned to set <code>trust</code> authentication for all users in <code>pool_hba.conf</code> and then <code>md5</code> in <code>pg_hba.conf</code>, to basically disable pgpool authentication and do the actual authentication at PostgreSQL. But it is not possible - if different authentication methods are used - authentication will fail.</li></ul><p>It makes sense to have authentication for pgpool's administrative tasks, but introducing another authentication layer for query execution is pointless, and frankly speaking - stupid. When it comes to query execution pgpool should simply pass-through - it is not its responsibility to authenticate. It is not a special-ultra-security product, but failover / load-balancing product.</p><p>Sorry for criticism! Let's do this. There are few things we need to do, so let's start by setting the following in <code style="line-height: 1.42857;">pgpool.conf</code> file:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">enable_pool_hba = on
pool_passwd = &#39;pool_passwd&#39;</pre>
</div></div><p>Next we'll create <code>pool_hba.conf</code> file, by copying from template (remember, while installing pgpool-II in <a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+4">PostgreSQL HA with pgpool-II - Part 4</a> we've prepared some templates);</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">cp /etc/pgpool2/3.5.2/pool_hba.conf.sample /etc/pgpool2/3.5.2/pool_hba.conf</pre>
</div></div><p><code>pool_hba.conf</code> is very similar to <code>pg_hba.conf</code>, except for few limitations (see <a class="external-link" href="http://www.pgpool.net/docs/latest/pgpool-en.html#hba" rel="nofollow">pgpool manual</a> for details). For the purpose of this tutorial I'll only add one line that allows all users to access all databases from my network (10.1.0.0/16) by using md5 authentication:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">host all all 10.1.0.0/16 md5</pre>
</div></div><p>In order to enable md5 authentication we have to create <code>pool_passwd</code> file. Path and the name of the file are specified in pgpool.conf file (see above). Another interesting pgpool team's decision is that path of the file is specified relative to <code>pgpool.conf</code> file itself, meaning that in our case <code>pool_passwd</code> file has to be placed in the same directory as <code>pgpool.conf</code> file. Content of the <code>pool_passwd</code> file is (in a way) very similar to content of <code>pcp.conf</code> file we've created in <a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+5">the previous part of this tutorial</a>, but <code>pool_passwd</code> file cannot contain comments nor empty lines. Another difference is that md5 hash of the password cannot be created in the same way as for <code>pcp.conf</code> file (no doubt that they want you suffer). Entries in <code>pool_passwd</code> file should be created in the following way:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">pg_md5 -f /etc/pgpool2/3.5.2/pgpool.conf -m -u postgres postgrespassword</pre>
</div></div><p>Here I've added user &quot;postgres&quot; with password &quot;postgrespassword&quot; to <code>pool_passwd</code> file. The command will execute without any command output - it adds user and password to <code>pool_passwd</code> file automatically (if the file does not exist it'll be created). As you can see it also requires path to <code>pgpool.conf</code> file as input argument (obviously to see where <code>pool_passwd</code> file is). After the execution you can check <code>/etc/pgpool2/3.5.2/pool_passwd</code> file content, and you'll find something like the following there:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">postgres:md55cb5bf77d7027e6c4e50fa4112df4d63</pre>
</div></div><p>If you have multiple users - you'll have multiple line in the file. You can also add lines manually, but if you do so you need to:</p><ul><li>Ensure that newly added line ends with new-line character. If there's no new-line character at the next execution <code>pg_md5</code> command will concatenate the next user and its password in the same line.</li><li>Find a way to create password hash. As I've already mentioned it is not the same hash as in <code>pcp.conf</code> file, and I don't have a clue how this one can be generated.</li></ul><p>Finally you need to ensure that md5 access for a particular user is also enabled in <code>pg_hba.conf</code>.</p><div class="confluence-information-macro confluence-information-macro-information"><p class="title">Important</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Don't forget: usernames and password <strong>have to be exactly the same</strong> as in PostgreSQL.</p></div></div><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.5.Startingpgpool-II">6.5. Starting pgpool-II</h2><p>We have finally finished with pgpool-II configuration, so we can enable and start the service:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">update-rc.d pgpool2 enable
service pgpool2 start</pre>
</div></div><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.6.Testingpgpool-II">6.6. Testing pgpool-II</h2><p>If you've done everything right now you should be able to see pgpool-II running. You can test the following:</p><ul><li>'<code>service pgpool2 status</code>' should report that the service is running on both machines;</li><li>'<code>ifconfig -a</code>' should show you that one machine has additional IP address (virtual IP) labeled with <code>eth0:0</code>;</li><li>You should be able to connect to pgpool-II from any other server by using virtual IP and port 5432. You can try with pgAdmin3 for example.</li></ul><h2 id="PostgreSQLHAwithpgpool-II-Part6-6.7.InstallingpgpoolAdmin">6.7. Installing pgpoolAdmin</h2><p>It is another part of the procedure that is not well documented, but luckily it is not too hard figure it out. About the <a class="external-link" href="http://www.pgpool.net/docs/pgpoolAdmin/en/install.html" rel="nofollow">official documentation</a> I'll tell you just two things:</p><ul><li>It dates back to 2006-2008, and its created for version 2.1 (the current version is 3.5.2);</li><li>It is written in almost not-understandable English (i.e. &quot;<em>To execute pgpool and the pcp tool set up from the Apach user, the right of access is set.</em>&quot;)</li></ul><h3 id="PostgreSQLHAwithpgpool-II-Part6-6.7.1.Preparing.pcppassFile">6.7.1. Preparing <code>.pcppass</code> File</h3><p>This file is needed by pgpoolAdmin for authentication for pcp commands. As you might remember in <a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+5">the previous part</a> we've created <code>pcp.conf</code> file that contains authentication info for executing pcp commands (i.e. <code>pcp_node_count</code>, <code>pcp_node_info</code>, etc.). The very same file and the same authentication info is used for authenticating to pgpoolAdmin portal. For example, we've created there user &quot;admin&quot; with password &quot;pa55w0rd&quot;, and now we'll use this combination to login to pgpoolAdmin portal. But it is not the end of authentication - even when you are logged in to pgpoolAdmin portal different portal functions are trying to execute pcp commands in background, and every execution must be authenticated. Although you've submitted username/password while logging in, the portal does not store this info, and needs username/password for every pcp command execution. This is where <code>.pcppass</code> file becomes important - the portal will always read username/password from the file, without bothering you to enter it again and again.</p><p><code>.pcppass</code> file is very similar to <code>.pgpass</code> file we've created in <a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+4">PostgreSQL HA with pgpool-II - Part 4</a>, with only difference that <code>.pcppass</code> file misses database part. It means that format of <code>.pcppass</code> file entries is:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">hostname:port:username:password</pre>
</div></div><p>In our case we'll create <code>.pcppass</code> file as:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">*:*:admin:pa55w0rd</pre>
</div></div><p>You can read this as: all hosts, all ports, user admin, password pa55w0rd. There are several things to note about the file and its content:</p><ul><li>Username / password combination <strong>must match</strong> to one used while creating <code>pcp.conf</code> file, with a difference that in <code>pcp.conf</code> file we need to use md5 hash of the password, while in <code>.pcppass</code> file we need to use plain password itself.</li><li><code>.pcppass</code> file we should be placed in user's home directory. Actually it is possible to place the file wherever you want and specify its location in an environment variable (as explained <a class="external-link" href="http://www.pgpool.net/docs/latest/pgpool-en.html#pcp_command_password" rel="nofollow">here</a>), but we'll use the first approach. </li><li>When the file is used by pgpoolAdmin portal (we are doing right now), it should be placed in home directory of the user account under which Apache runs, meaning in www-data's home directory. Home directory of www-data user is <code>/var/www</code>, so we need to place <code>.pcppass</code> file there.</li><li>When used with pgpoolAdmin portal the file must contain the same username/password used when we've logged in to the portal.</li></ul><h4 id="PostgreSQLHAwithpgpool-II-Part6-6.7.1.1..pcppassFileBeyondApache">6.7.1.1. .pcppass File Beyond Apache</h4><p>Although it is not related to pgpoolAdmin portal we are dealing with here, it is worthwhile to note that the file can be useful even when you are executing pcp commands from command line. In this case it will save you from always being prompted for password. But in this case it has:</p><ul><li>To be placed in home directory of the user who is executing the commands. For example, if you are executing commands as root user, the file should be placed in <code>/root/.pcppass</code>.</li><li>To contain appropriate username/password combination. When you are executing pcp commands from command line you can specify the username by using <code>-u</code> flag (i.e. '<code>pcp_node_info -u admin ...</code>'). If you've specified username this way, the file must contain this username and its corresponding password. Of course, the same username/password must also be specified in <code>pcp.conf</code> file. If you don't specify username by using <code>-u</code> flag, then your UNIX username will be used, meaning that if you are executing command as root user, <code>.pcppass</code> file (and again <code>pcp.conf</code> file also) must contain &quot;root&quot; username and its corresponding password. In this case your UNIX password <strong>does not have to match</strong> to the password specified in <code>pcp.conf</code> and <code>.pcppass</code> files.</li></ul><p>Still talking about command line usage, I'll tell you how you can know if <code>.pcppass</code> file is set as needed: When you try to execute any pcp command, if you get password prompt it means that the file is not in the appropriate way.</p><h3 id="PostgreSQLHAwithpgpool-II-Part6-6.7.2.pgpool.confandpcp.confFilePermissions">6.7.2. <code>pgpool.conf</code> and <code>pcp.conf</code> File Permissions</h3><p>Among other things, pgpoolAdmin portal provides you an interface for changing <code>pgpool.conf</code> file, and interface for changing password (meaning changing <code>pcp.conf</code> file). But to be able to save the changes, the portal has to have write permissions on mentioned files. For this reason we'll change file permissions of these files:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">chown www-data /etc/pgpool2/3.5.2/pgpool.conf
chown www-data /etc/pgpool2/3.5.2/pcp.conf</pre>
</div></div><p>This ownership change won't break anything in our previous setup; postgres user (pgpool2 service runs under) does not changes these files anyway, only reads them, so it does have to be the owner.</p><h3 id="PostgreSQLHAwithpgpool-II-Part6-6.7.3.InstallingthePortal">6.7.3. Installing the Portal</h3><p>Finally we can install the portal itself. As I've mentioned, pgpoolAdmin installation is not too hard, and I'll simply provide a script that performes it, with explanations in comments:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence"># Navigate to temporary directory
cd /tmp

# If archive exists delete it
if [ -f pgpoolAdmin-3.5.2.tar.gz ]; then
	rm pgpoolAdmin-3.5.2.tar.gz
fi

# Download installation archive
wget http://www.pgpool.net/download.php?f=pgpoolAdmin-3.5.2.tar.gz -O pgpoolAdmin-3.5.2.tar.gz

# If extracted directory exists delete it
if [ -d pgpoolAdmin-3.5.2 ]; then
	rm -r pgpoolAdmin-3.5.2.tar.gz
fi

# Extract the archive
tar -xzf pgpoolAdmin-3.5.2.tar.gz

# Delete archive file
rm pgpoolAdmin-3.5.2.tar.gz

# If virtual directory exists delete it
if [ -e /var/www/html/pgpooladmin ]; then
	rm -r /var/www/html/pgpooladmin
fi

# Move extracted archive to the new location (under Apache root directory)
mv pgpoolAdmin-3.5.2 /var/www/html/pgpooladmin

# Change ownership of the directory
chown root:root -R /var/www/html/pgpooladmin

# Adjust file and folder permissions
chmod 0777 /var/www/html/pgpooladmin/templates_c
chown www-data /var/www/html/pgpooladmin/conf/pgmgt.conf.php
chmod 0644 /var/www/html/pgpooladmin/conf/pgmgt.conf.php</pre>
</div></div><p>After executing the script you should be able to access the portal, so first check if Apache / PHP are working as expected by opening <span class="nolink">http://it-rdbms01/pgpooladmin/install/phpinfo.php</span> (you should change hostname appropriately). At this location you should find standard phpinfo page starting with something like:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/phpheader.png?version=1&amp;modificationDate=1464340923420&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/phpheader.png?version=1&amp;modificationDate=1464340923420&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735762" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="phpheader.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>Two parts are especially important: Multibyte Support should be enabled:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/mbstring.png?version=1&amp;modificationDate=1464341160956&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/mbstring.png?version=1&amp;modificationDate=1464341160956&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735763" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="mbstring.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>And PostgreSQL Support should be enabled:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/pgsql.png?version=1&amp;modificationDate=1464341398900&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/pgsql.png?version=1&amp;modificationDate=1464341398900&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735764" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pgsql.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>If you don't see pgsql section at all, it's probably because Apache server was started before you've installed <code>php5-pgsql</code> package. Try with restarting Apache (<code>service apache2 restart</code>) and refreshing the page. If the section still missing ensure that <code>php5-pgsql</code> package is actually installed.</p><h4 id="PostgreSQLHAwithpgpool-II-Part6-6.7.3.1.InstallationWizard">6.7.3.1. Installation Wizard</h4><p>Once you've ensured that everything is ok with PHP and Apache, start installation wizard by opening <span class="nolink">http://it-rdbms01/pgpooladmin/install/index.php</span> (again change the host). You should get something like:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/step1.png?version=1&amp;modificationDate=1464341822631&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/step1.png?version=1&amp;modificationDate=1464341822631&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735765" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="step1.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>Select your language and click &quot;Next&quot;.</p><p>The second step of the wizard is &quot;Directory Check&quot;. You should see two green checks. If not - you probably haven't set the appropriate file permissions (recheck the last three lines form the script above). Click &quot;Next&quot;.</p><p>In the third step there are many fields with green checks and red X's. In order to finish the installation we need to ensure that there's no more red X's, but <strong><span style="color: rgb(51,153,102);">DON'T PANIC!</span></strong> Probably the only cause for red X's is wrong path, and we'll fix it. Here's what I've had to change to make it green:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd">pgpool.conf File</td><td class="confluenceTd">/etc/pgpool2/3.5.2/pgpool.conf</td></tr><tr><td class="confluenceTd">pcp.conf File</td><td class="confluenceTd">/etc/pgpool2/3.5.2/pcp.conf</td></tr><tr><td class="confluenceTd">pgpool Command</td><td class="confluenceTd">/usr/sbin/pgpool</td></tr><tr><td class="confluenceTd"><span style="color: rgb(0,0,0);">PCP directory</span></td><td class="confluenceTd">/usr/sbin</td></tr></tbody></table></div><p>If you've used different directories during pgpool-II installation process - you'll have to appropriately change the values here also.</p><p>After changing the values click &quot;Check&quot; button again and you should get all greens. Click &quot;Next&quot;. You should get something like:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/welcome.png?version=1&amp;modificationDate=1464342669283&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/welcome.png?version=1&amp;modificationDate=1464342669283&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735766" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="welcome.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>As you can see we should now delete <code>/var/www/html/pgpooladmin/install</code> directory, so do it. Click &quot;top&quot; button, and you'll end up on a login page. Enter username / password (you've defined while creating pcp.conf file in <a href="/blog/2016/05/21/PostgreSQL+HA+with+pgpool-II+-+Part+5">PostgreSQL HA with pgpool-II - Part 5</a>), and you should be in. You should see something like:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/home.png?version=1&amp;modificationDate=1464342994674&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/home.png?version=1&amp;modificationDate=1464342994674&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735767" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="home.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>If you see some error messages like &quot;failed to execute pcp_...&quot;, &quot;e1002&quot;, etc., chances are that you haven't set <code>.pcppass</code> file appropriately. Look again above and recheck that the file is set as needed.</p><p>Note that since I've used &quot;admin&quot; user (which is not PostgreSQL user) to login to this session, there's &quot;superuser: unknown (Connection error)&quot; on the previous screenshot. Also majority of buttons is grayed out. But if you login by using &quot;postgres&quot; user, you'll get something like:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/pgpool_postgres.png?version=1&amp;modificationDate=1464913841236&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/pgpool_postgres.png?version=1&amp;modificationDate=1464913841236&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="4915209" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pgpool_postgres.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><h2 id="PostgreSQLHAwithpgpool-II-Part6-AllProblemsSolved???">All Problems Solved???</h2><p>Well, no. Obviously pgpool-II is very immature (probably even too immature) product that won't ever stop causing some headache. At this moment I'm struggling with a new question: why two pgpool-II instances (which are targeting the same cluster) are showing me different info??? I'll give you an example - screenshot of my IT-RDBMS01 pgpool instance (the same screenshot as the previous one):</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/pgpool_screen1.png?version=1&amp;modificationDate=1464914198078&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/pgpool_screen1.png?version=1&amp;modificationDate=1464914198078&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="4915210" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pgpool_screen1.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>As you can see even a single instance provides contradictory info: node 1 is at same time &quot;Down&quot; and &quot;Up&quot;. And there's never and nowhere described button &quot;Return&quot;. What the hack this button does? And what it means in the first place? Term &quot;return&quot; hasn't been used in PostgreSQL replication terminology, so obviously pgpool team has introduced a new one without any explanation. Guys, you can name a button &quot;Pray it back&quot; or &quot;Normalize it up&quot;, but at least you should explain what actually this button does. Does this button initializes recovery (<code>recovery_1st_stage</code>, etc) or not?</p><p>And here's the screenshot from my IT-RDBMS02 instance:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="/confluence/download/attachments/3735725/pgpool_screen2.png?version=1&amp;modificationDate=1464914779685&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/pgpool_screen2.png?version=1&amp;modificationDate=1464914779685&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="4915211" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pgpool_screen2.png" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/png" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>The same cluster, the same servers, the same moment, two pgpool-II instances. Disappointing... Very disappointing.</p><h2 id="PostgreSQLHAwithpgpool-II-Part6-WheretoGoNext?">Where to Go Next?</h2><p>Well, go wherever you want! I'm not your mom! <img class="emoticon emoticon-smile" src="/confluence/s/en_GB/6218/d2c5c255bb54cd737858a680a1ead2532cae5842.22/_/images/icons/emoticons/smile.png" data-emoticon-name="smile" alt="(smile)" /></p><p>Just kidding, of course. Now you know how to implement PostgreSQL High Availability with pgpool-II so the world is yours! But if you insist on my advice - beer is always a good choice.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="/confluence/download/attachments/3735725/beer.jpg?version=1&amp;modificationDate=1464343595626&amp;api=v2" data-image-src="/confluence/download/attachments/3735725/beer.jpg?version=1&amp;modificationDate=1464343595626&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="3735768" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="beer.jpg" data-base-url="https://www.itenlight.com/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="3735725" data-linked-resource-container-version="23"></span></p><p>

<script type="text/javascript">//<![CDATA[

	var fd_disqus_use=true;
	var disqus_identifier='$paramThreadIdentifier';
	var disqus_shortname='fatdragon';
	var disqus_url='https://www.itenlight.com/blog/2016/05/25/PostgreSQL+HA+with+pgpool-II+-+Part+6';

//]]>
</script></p>
        </div>

                
    
    
    
			</div>
		</article>
	</div>
			
	<div style="clear:both;"></div>
	
</div>


<div id="rw_blogpost_nav">

  			<div id="rw_blogpost_id" style="display:none;">3735725</div>
	</div>

	
<div class="rw_blogpost_share">
	
		<div id="rw_share_navigation"></div>
    
		<a id="rw_blogpost_permalink" class="aui-button">
		<span class="rw_link">
			Link to this page
		</span>
	</a>

        </div>


<div style="clear:both;"></div>	



			    
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="3735725" entitytype="blogpost">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
                    
        <li class="aui-label " data-label-id="3866625"><a class="aui-label-split-main" href="/confluence/label/BLOG/postgresql" rel="tag">postgresql</a></li><li class="aui-label " data-label-id="3866626"><a class="aui-label-split-main" href="/confluence/label/BLOG/pgpool2" rel="tag">pgpool2</a></li><li class="aui-label " data-label-id="3866627"><a class="aui-label-split-main" href="/confluence/label/BLOG/db" rel="tag">db</a></li><li class="aui-label " data-label-id="3866628"><a class="aui-label-split-main" href="/confluence/label/BLOG/ha" rel="tag">ha</a></li>
            </ul>

    </div>
</div>
</div>
	   
		    




            
        

<div class="hidden parameters">
    <input type="hidden" id="pageTitle" value="/2016/05/25/PostgreSQL HA with pgpool-II - Part 6">
</div>







                        
    
<div id="comments-section" class="pageSection group">
        
    



</div>
        






	<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="https://www.itenlight.com/blog/2016/05/25/PostgreSQL+HA+with+pgpool-II+-+Part+6"
    dc:identifier="https://www.itenlight.com/blog/2016/05/25/PostgreSQL+HA+with+pgpool-II+-+Part+6"
    dc:title="PostgreSQL HA with pgpool-II - Part 6"
    trackback:ping="https://www.itenlight.com/confluence/rpc/trackback/3735725"/>
</rdf:RDF>
-->
	

		    

	





    
	

    
    
    
	

    







    




    
    

    
    
    

    

        



        </div><!-- .rw_content -->
    </div><!-- #rw_main_column -->

        <div id="rw_right_column" class="rw_visibility_hidden">
        <div>            
  			<div id="rw_blogpost_calendar" class="rw_sidebar_section rw_corners">
				<div> 										<div id="rw_blog_calendar_wrapper" >
	<div id="rw_blog_calendar">
	</div>
	
						<div id="rw_blogpost_id" style="display:none;">3735725</div>
		<div id="rw_space_key" style="display:none;">BLOG</div>
		</div>
				</div>
		</div>
	
        </div>
    </div>
    <div class="rw_clear"></div>
</div><!-- #content -->
										<script>
						// Now we can show the sidebar..
						$('#rw_left_column').removeClass('rw_visibility_hidden');
						$('#rw_right_column').removeClass('rw_visibility_hidden');
					</script>
								
		        <div style="clear:both;"></div>
		    </div><!-- \#main -->
	
	
		
				</div>





	<div
		id="rw_footer_wrapper"
		
					        	class="rw_theme_dark"
				>
    	<div id="rw_footer_container">
			
									
							<div id="rw_footer_content">
				  	<p>Powered by <a href="http://www.atlassian.com/software/confluence" class="external-link" rel="nofollow">Atlassian Confluence</a> 5.9.10, themed by <a href="http://www.refinedwiki.com" class="external-link" rel="nofollow">RefinedTheme</a> 5.0.9</p>
				</div>
			    	</div>
	</div>

						


                                
            	
	    

						<div class="rw_bg_shadow">
    <div class="rw_shadow_container">
        <div class="rw_shadow_left"></div>
        <div class="rw_shadow_top"></div>
        <div class="rw_shadow_right"></div>
    </div>
</div>

			</div> <!-- rw_main -->

						

                <div class="rw_background_section_general
                                                                                "
        ></div>
    
                <div class="rw_background_section_background1
                                                    "
        ></div>
    

<div id='rw_popup_bg' style='display:none;'></div>

			
		</div><!-- rw_wrapper -->
		
	
		
		
	
			
	
	<div id="fd_buy_me_a_beer" style="display:none;visibility:hidden;">
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RFGX5T23HR96G">
<input type="hidden" name="on0" value="Size">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="image_url" value="https://www.itenlight.com/confluence/fdfiles/black190.png">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="return" value="https://www.itenlight.com/confluence/pages/viewpage.action?pageId=5079104">
<input type="hidden" name="cancel_return" value="https://www.itenlight.com/confluence/pages/viewpage.action?pageId=5079106">
<table style="border:none;" class="fd_remove_class">
	<tr class="fd_remove_class">
		<td rowspan="2" style="padding-right:10px;" valign="middle" class="fd_remove_class">
			<strong>Want to PayPal me a beer?</strong>
		</td>
		<td style="width:1%;padding-right:6px;" valign="middle" class="fd_remove_class">
			<select name="os0" onchange="switchBeerImage(event);">
				<option value="Small" data-beer-index="0" selected>Small $2.00</option>
				<option value="Big" data-beer-index="1">Big $5.00</option>
				<option value="A lot!" data-beer-index="2">A lot! $10.00</option>
			</select> 
		</td>
	</tr>
	<tr class="fd_remove_class">
		<td style="width:1%;" valign="middle" class="fd_remove_class">
			<input type="image" src="/confluence/fdfiles/small.png" border="0" name="submit" alt="Pay with PayPal and let them to get a sip...">
		</td>
	</tr>
</table>
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</div>
<script type="text/javascript">//<![CDATA[

    AJS.toInit(function(){

	AJS.$(".fd_remove_class").removeClass();

    	var byMeABeerDiv = AJS.$("#fd_buy_me_a_beer");
    	var byMeABeerContainer = AJS.$("#rw_blogpost_calendar");

    	if (byMeABeerDiv.length && byMeABeerContainer.length) {
    		byMeABeerContainer.prepend(byMeABeerDiv);
    		byMeABeerDiv.show();
    		byMeABeerDiv.css("visibility", "visible");
    	} 

    });

//]]>
</script>

<script type="text/javascript">//<![CDATA[

AJS.toInit(function(){

	if (typeof fd_disqus_use !== typeof undefined && fd_disqus_use == true && AJS.$('#comments-section')){

		if (typeof disqus_identifier === typeof undefined || disqus_identifier == '' || disqus_identifier == '$paramThreadIdentifier')
			disqus_identifier = 'itenlight_id_' + AJS.params.pageId;
		var disqus_config = function () {
			this.page.url=disqus_url;
			this.page.identifier=disqus_identifier;
		};
		
		// replace the comments section  
		AJS.$('#comments-section').after('<div id="disqus_thread"></div>').remove();
  
		(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');

			s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
	}

});

//]]>
</script>
<script id="dsq-count-scr" src="//fatdragon.disqus.com/count.js" async></script>
<script src="https://apis.google.com/js/platform.js" async defer></script>



</div><!-- \#full-height-container -->
</div><!-- \#page -->
</body>
</html>
